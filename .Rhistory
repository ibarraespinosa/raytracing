ma98 <- ma98[ma98$iday %in% c(6,12),]
plot(y = ma98$lat,
x = ma98$lon,
type = "b")
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -c(15),
dt = 6,
direction = -1,
interpolation = "trin")
mm <- ma98
ma98 <- mm
ma98 <- ma98[ma98$iday %in% c(6,18),]
# head(ma98)
plot(ma98["iday"])
plot(y = ma98$lat,
x = ma98$lon,
type = "b")
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -c(15),
dt = 6,
direction = -1,
interpolation = "trin")
mm <- ma98
ma98 <- mm
ma98 <- ma98[ma98$iday %in% c(12,18),]
# head(ma98)
plot(ma98["iday"])
plot(y = ma98$lat,
x = ma98$lon,
type = "b")
ma98 <- mm
ma98 <- ma98[ma98$iday %in% c(18),]
plot(y = ma98$lat,
x = ma98$lon,
type = "b")
ma98 <- mm
ma98 <- ma98[ma98$iday %in% c(12),]
plot(y = ma98$lat,
x = ma98$lon,
type = "b")
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -c(15),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
ray_path(x = x$lon, y = x$lat)
rp <- ray_path(x = x$lon, y = x$lat)
plot(rp)
rp
plot(ma98$geometry)
x$geometry
plot(x$geometry, reset = FALSE)
plot(x$geometry, reset = FALSE)
plot(x$geometry, reset = FALSE, axes = TRUE)
plot(rp, add = TRUE)
plot(rp, add = TRUE, pch = 16, size = 4)
plot(x$geometry, reset = FALSE, axes = TRUE, pch = 16, size = 4)
plot(rp, add = TRUE)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16, ltw = 6)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16, lwd = 6)
plot(rp, add = TRUE)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16, pwd = 6)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16, lwd = 6)
plot(rp, add = TRUE)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16, lwd = 1)
plot(rp, add = TRUE)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex = 5)
plot(rp, add = TRUE)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex = 2)
plot(rp, add = TRUE)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -seq(15,16,0.5),
dt = 6,
direction = -1,
interpolation = "trin")
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex = 2)
plot(rp, add = TRUE)
-seq(15,16,0.5)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -seq(15.5),
dt = 6,
direction = -1,
interpolation = "trin")
seq(15.5)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -(15.5),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -(16),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex = 2)
plot(rp, add = TRUE)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -(16.5),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex = 2)
plot(rp, add = TRUE)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -(17),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex = 2)
plot(rp, add = TRUE)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex= 2)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -c(15),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex= 2)
plot(rp, add = TRUE)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -c(14),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex= 2)
plot(rp, add = TRUE)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -c(14.5),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
rp <- ray_path(x = x$lon, y = x$lat)
plot(y = x$lat,
x = x$lon,
type = "b")
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex= 2)
plot(rp, add = TRUE)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -c(15),
dt = 6,
direction = -1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
rp <- ray_path(x = x$lon, y = x$lat)
plot(y = x$lat,
x = x$lon,
type = "b")
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex= 2)
plot(rp, add = TRUE)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(130),
y0 = -c(15),
dt = 6,
direction = 1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(140),
y0 = c(10),
dt = 6,
direction = 1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
plot(x$geometry, reset = FALSE,
axes = TRUE, pch = 16,cex= 2)
plot(rp, add = TRUE)
library(ggplot2)
ggplot() +
# geom_polygon(data = mapWorld, aes(x=long, y = lat, group = group)) +
# geom_sf(data = l3) +
geom_sf(data = x$geometry, color = "red")
K
devtools::load_all(".")
library(raytracing)
rm(list = ls()); graphics.off(); gc()
# MAGANA AMBRIZZI
library(raytracing)
library(ggplot2)
input <- "~/Documents/2020_AUSTRALIA/MaranaAmbrizzi2005/dados/uwnd_pl_250hPa_mean_1997-98DJF.nc"
br <- betaks(input)
filled.contour(br$betam)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(140),
y0 = c(10),
dt = 6,
direction = 1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
rp <- ray_path(x = x$lon, y = x$lat)
plot(y = x$lat,
x = x$lon,
type = "b")
plot(x$geometry,
reset = FALSE,
axes = TRUE,
pch = 16,
cex= 2)
plot(rp, add = TRUE)
ggplot() +
# geom_polygon(data = mapWorld, aes(x=long, y = lat, group = group)) +
# geom_sf(data = l3) +
geom_sf(data = x$geometry, color = x$K) +
geom_sf(data = co_l3, color = "blue") +
# annotate("point", x = l3$x0 - 360, y = l3$y0, size = 4) +
annotate("point",
x = l3$x0 - 360,
y = l3$y0,
size = 3,
color = "red") +
annotate("point",
x = co_l3$x0 - 360,
y = co_l3$y0,
size = 3,
color = "blue") +
ggtitle("Magaña & Ambrizzi (2005): DJF/1997-98 (vermelho) \nCoelho et al. (2015): JFM/2014 (azul)                                                         K = 3")
ggplot() +
# geom_polygon(data = mapWorld, aes(x=long, y = lat, group = group)) +
# geom_sf(data = l3) +
geom_sf(data = x$geometry, color = x$K)
ggplot() +
geom_sf(data = x$geometry, color = x$K) +
geom_sf(data = rp, color = x$K) +
# annotate("point", x = l3$x0 - 360, y = l3$y0, size = 4) +
annotate("point",
x = l3$x0 - 360,
y = l3$y0,
size = 3,
color = "red") +
annotate("point",
x = co_l3$x0 - 360,
y = co_l3$y0,
size = 3,
color = "blue") +
ggtitle("Magaña & Ambrizzi (2005): DJF/1997-98 (vermelho) \nCoelho et al. (2015): JFM/2014 (azul)                                                         K = 3")
ggplot() +
geom_sf(data = x$geometry, color = x$K) +
geom_sf(data = rp, color = x$K)
class(rp)
ggplot() +
geom_sf(data = x$geometry, color = x$K) +
geom_sf(data = rp, color = x$K)
ggplot() +
geom_sf(data = x$geometry, color = x$K) +
geom_sf(data = rp, color = x$K, aes())
ggplot() +
geom_sf(data = x$geometry, aes(color = K)) +
geom_sf(data = rp, aes(color = K))
x$geometry
ggplot() +
geom_sf(data = x, aes(color = K)) +
geom_sf(data = rp, aes(color = K))
ggplot() +
geom_sf(data = x, aes(color = rp$K)) +
geom_sf(data = rp, aes(color = K))
x
rp
ggplot() +
geom_sf(data = x, aes(color = K)) +
geom_sf(data = rp)
ggplot() +
geom_sf(data = x, aes(color = as.factor(K))) +
geom_sf(data = rp)
# # Ficou melhor ateh agora.
ma98 <- ray_source(betam = br$betam,
u = br$u,
lat = br$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -c(140),
y0 = c(10),
dt = 6,
direction = 1,
interpolation = "trin")
plot(ma98["iday"])
x <- ma98[ma98$iday %in% c(12),]
plot(y = x$lat,
x = x$lon,
type = "b")
rp <- ray_path(x = x$lon, y = x$lat)
class(rp)
plot(x$geometry,
reset = FALSE,
axes = TRUE,
pch = 16,
cex= 2)
plot(rp, add = TRUE)
ggplot() +
geom_sf(data = x, aes(color = as.factor(K))) +
geom_sf(data = rp)
devtools::load_all(".")
library(raytracing)
library(raytracing)
knitr::opts_chunk$set(echo = FALSE)
input <- system.file("extdata",
"uwnd_pl_250hPa_mean_1997-98DJF.nc",
package = "raytracing")
b <- betaks(u = input)
rt <- ray_source(betam = b$betam,
u = b$u,
lat = b$lat,
K = c(3,4,5),
itime = 10*4,
x0 = -128,
y0 = -17,
dt = 6,
interpolation = "trin")
input <- system.file("extdata",
"uwnd.mon.mean_200hPa_2014JFM.nc",
package = "raytracing")
b <- betaks(u = input)
rt <- ray(betam = b$betam,
u = b$u,
lat = b$lat,
K = 3,
itime = 10 * 4,
x0 = -130,
y0 = -30,
dt = 6,
direction = -1,
interpolation = "trin")
input <- system.file("extdata",
"uwnd.mon.mean_200hPa_2014JFM.nc",
package = "raytracing")
b <- betaks(u = input)
rt <- ray(betam = b$betam,
u = b$u,
lat = b$lat,
K = 3,
itime = 10 * 4,
x0 = -130,
y0 = -30,
dt = 6,
direction = -1,
interpolation = "trin")
rp <- ray_path(rt$lon, rt$lat)
plot(rp)
ww <- sf::st_as_sf(maps::map(plot = FALSE, fill = TRUE))
ww <- st_union(ww)
ww <- st_cast(ww, "MULTILINESTRING")
plot(ww, reset = F, axes = T, graticule = T, col = "grey",
main = "Coelho et al. (2015): JFM/2015")
plot(rp,
add = TRUE,
lwd = 2,
col = "black")
